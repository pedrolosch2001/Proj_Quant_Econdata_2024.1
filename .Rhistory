library(tidyverse)
library(scales)
library(tidyquant)
library(tidyverse)
library(scales)
library(tidyquant)
library(lubridate)
library(writexl)
# Pacotes para modelagem
library(PerformanceAnalytics)
library(xts)
library(forecast)
# Pacotes para dados
library(rbcb)
library(rb3)
library(ggthemes)
library(rvest) # webscraping
# Baixando os dados ---------------------------------------------
library(zoo)
library(zoo)
nomes_ativos <- "https://br.tradingview.com/markets/stocks-brazil/market-movers-large-cap/" %>%
read_html() %>%
html_elements(".tickerName-GrtoTeat") %>%
html_text() %>%
str_c(".SA")
?write_xlsx
write_xlsx(nomes_ativos,path = data ,'nomes_ativos.xlsx')
ativos = tq_get(x = nomes_ativos,
from = '2019-01-01',
to = '2023-12-31')
ibov = tq_get(x = '^BVSP',
from = '2019-01-01',
to = '2023-12-31')
# Pacotes para manipulacao
library(tidyverse)
ativos
ativos %>%
subset(data, format(date, "%Y") %in% c("2019", "2020", "2021", "2022", "2023"))
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date))
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(month, year, symbol) %>%
dplyr::slice_max(date)
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
subset(data, format(date, "%Y") %in% c("2019", "2020", "2021", "2022", "2023"))
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::filter(date >= "2019-01-01" & date <= "2023-12-31")
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
group_by(symbol) %>%
dplyr::filter(!any(is.na(open) | is.na(high) | is.na(low) | is.na(close) | is.na(volume) | is.na(adjusted))) %>%
ungroup()
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
group_by(symbol) %>%
filter(all(year >= 2019)) %>%
ungroup()
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
group_by(symbol) %>%
filter(all(year >= 2019)) %>%
ungroup()
ativos = tq_get(x = nomes_ativos,
from = '2013-01-01',
to = '2023-12-31')
ibov = tq_get(x = '^BVSP',
from = '2013-01-01',
to = '2023-12-31')
ativos
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
group_by(symbol) %>%
filter(all(year >= 2013)) %>%
ungroup()
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
group_by(symbol) %>%
filter(all(year >= 2013)) %>%
ungroup()
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
group_by(symbol) %>%
filter(all(year >= 2013)) %>%
ungroup() %>%
select(-c(month, year, day))
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date),1))
day(date),1)
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date)))
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date))) %>%
dplyr::arrange(date) %>%
dplyr::rename(acao = adjusted)
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date))) %>%
dplyr::arrange(date) %>%
dplyr::rename(acao = adjusted, ticker = symbol) %>%
dplye::select(symbol, date, acao)
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date))) %>%
dplyr::arrange(date) %>%
dplyr::rename(acao = adjusted, ticker = symbol) %>%
dplyr::select(symbol, date, acao)
ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date))) %>%
dplyr::arrange(date) %>%
dplyr::rename(acao = adjusted, ticker = symbol) %>%
dplyr::select(ticker, date, acao)
ativos_filtrado = ativos %>%
dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date))) %>%
dplyr::arrange(date) %>%
dplyr::rename(acao = adjusted, ticker = symbol) %>%
dplyr::select(ticker, date, acao)
ativos_modelagem = ativos_filtrado %>%
tidyr::pivot_wider(names_from = ticker,
values_from = acao)
ibov = tq_get(x = '^BVSP',
from = '2013-01-01',
to = '2023-12-31')
ibov
ativos_modelagem = ativos_filtrado %>%
tidyr::pivot_wider(names_from = ticker,
values_from = acao)
ativos_modelagem = ativos_filtrado %>%
tidyr::pivot_wider(names_from = ticker,
values_from = acao) %>%
print()
ativos_modelagem = ativos_filtrado %>%
tidyr::pivot_wider(names_from = ticker,
values_from = acao) %>%
print()
ibov %>% dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date))) %>%
dplyr::arrange(date) %>%
dplyr::rename(acao = adjusted, ticker = symbol) %>%
dplyr::select(ticker, date, acao) %>% print()
ibov_filtrado = ibov %>% dplyr::mutate(month = month(date),
year = year(date),
day = day(date)) %>%
dplyr::group_by(symbol) %>%
dplyr::filter(all(year >= 2013)) %>%
dplyr::ungroup() %>%
dplyr::select(-c(month, year, day)) %>%
dplyr::mutate(date = make_date(year(date),
month(date),
day(date))) %>%
dplyr::arrange(date) %>%
dplyr::rename(acao = adjusted, ticker = symbol) %>%
dplyr::select(ticker, date, acao) %>% print()
ibov_pivot_wider = ibov_filtrado %>%
tidyr::pivot_wider(names_from = ticker,
values_from = acao)
names(ativos)
names(ativos_filtrado$ticker)
names(ativos_filtrado$ticker)
unique(ativos$ticker)
unique(ativos_filtrado$ticker)
write_rds(ativos_filtrado, 'ativos_filtrado.rds')
write_rds(ativos_filtrado, file.path(data),  'ativos_filtrado.rds')
write_rds(ativos_filtrado, file.path(data, 'ativos_filtrado.rds'))
write_rds(ativos_filtrado, file.path(Proj_Quant_Econdata_2024.1\\data, 'ativos_filtrado.rds'))
write_rds(ativos_filtrado, file.path(Proj_Quant_Econdata_2024.1\data, 'ativos_filtrado.rds'))
write_rds(ativos_filtrado, file.path(Proj_Quant_Econdata_2024.1//data, 'ativos_filtrado.rds'))
write_rds(ativos_filtrado, file.path(Proj_Quant_Econdata_2024.1/data, 'ativos_filtrado.rds'))
write_rds(ativos_filtrado, file.path(/data, 'ativos_filtrado.rds'))
write_rds(ativos_filtrado, file.path('/data', 'ativos_filtrado.rds'))
write_rds(ativos_filtrado, file.path(data, 'ativos_filtrado.rds'))
getwd()
write_rds(ativos_filtrado, file.path(getwd(), 'data', 'ativos_filtrado.rds'))
write_rds(ativos_modelagem, file.path(getwd(), 'data', 'ativos_modelagem.rds'))
write_rds(ibov_filtrado, file.path(getwd(), 'data', 'ibov_filtrado.rds'))
write_rds(ibov_pivot_wider, file.path(getwd(), 'data', 'ibov_pivot_wider.rds'))
ativos_sss = read_rds('data/ativos_filtrado.rds')
View(ativos_sss)
ativos_filtrado = read_rds('data/ativos_filtrado.rds')
ativos_modelagem = read_rds('data/ativos_modelagem.rds')
ibov_filtrado = read_rds('data/ibov_filtrado.rds')
ibov_pivot_wider = read_rds('data/ibov_pivot_wider.rds')
unique(ativos_filtrado$ticker) # para ver os nomes dos ativos
View(ativos_filtrado)
View(ativos_filtrado, ativos_modelagem, ibov_filtrado, ibov_pivot_wider)
View(c(ativos_filtrado, ativos_modelagem, ibov_filtrado, ibov_pivot_wider))
View(ativos_filtrado)
lapply(c(ativos_filtrado, ativos_modelagem), View())
lapply(c(ativos_filtrado, ativos_modelagem), View)
ibov_filtrado = read_rds('data/ibov_filtrado.rds') %>% View()
ibov_filtrado = read_rds('data/ibov_filtrado.rds') %>% print()
View(ativos_filtrado)
View(ativos_filtrado)
View(ibov_filtrado)
View(ibov_pivot_wider)
